<!DOCTYPE html>
<html lang="zh-CN">
<head>
<style>
/* 立即隐藏CMDB菜单项 - 防止闪烁 */
.nav-cmdb { display: none !important; }
.sidebar-item[data-page="CMDB"] { display: none !important; }
</style>
<script>
// 立即执行：尽早隐藏CMDB，防止闪烁
(function() {
    function hideCMDB() {
        var items = document.querySelectorAll('.sidebar-item');
        items.forEach(function(item) {
            var span = item.querySelector('span');
            if (span && span.textContent.trim() === 'CMDB') {
                item.style.display = 'none';
                item.setAttribute('data-hidden', 'true');
            }
        });
    }
    
    hideCMDB();
    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', hideCMDB);
    }
    
    setTimeout(hideCMDB, 10);
    setTimeout(hideCMDB, 100);
})();
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智能预测管理 - 人工智能运维平台</title>
    <link rel="stylesheet" href="libs/fontawesome/6.0.0/css/all.min.css">
    <script src="chart.js"></script>
    <link rel="stylesheet" href="智能预测管理.css">
    <style>
        /* 子页面样式 */
        .sub-page {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .sub-page.active {
            display: block;
            height: calc(100vh - 180px); /* 减去头部导航和工具栏高度 */
            /* 不在这里添加滚动条，避免与内层滚动条重复 */
        }
        
        /* 特殊处理：非智能统计页面需要滚动条 */
        .sub-page.active:not(#page-stats) {
            overflow-y: auto;
            padding: 20px;
            box-sizing: border-box;
        }
        
        /* 智能统计页面容器不显示滚动条 */
        #page-stats.sub-page.active {
            overflow: hidden;
            padding: 0;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 子菜单样式 */
        .sub-nodes {
            display: none;
            padding-left: 30px;
            margin-top: 5px;
        }

        .tree-node.expanded > .sub-nodes {
            display: block;
        }

        .expand-icon {
            transition: transform 0.3s;
            margin-right: 5px;
            font-size: 12px;
        }

        .tree-node.expanded > .node-item > .expand-icon {
            transform: rotate(90deg);
        }

        .sub-node {
            font-size: 13px;
            padding: 8px 12px;
            margin: 3px 0;
        }

        .sub-node:hover {
            background: #f0f0f0;
        }

        .sub-node.selected {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        /* 智能统计子页面样式 */
        .stats-sub-page {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .stats-sub-page.active {
            display: block;
            height: calc(100vh - 180px); /* 减去头部导航和工具栏高度 */
            overflow-y: auto; /* 添加垂直滚动条 */
            padding: 20px;
            box-sizing: border-box; /* 确保padding包含在高度内 */
        }

        /* 美化滚动条样式 - 只作用于实际需要滚动的容器 */
        .sub-page.active:not(#page-stats)::-webkit-scrollbar,
        .stats-sub-page.active::-webkit-scrollbar {
            width: 8px;
        }

        .sub-page.active:not(#page-stats)::-webkit-scrollbar-track,
        .stats-sub-page.active::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .sub-page.active:not(#page-stats)::-webkit-scrollbar-thumb,
        .stats-sub-page.active::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px;
            transition: background 0.3s;
        }

        .sub-page.active:not(#page-stats)::-webkit-scrollbar-thumb:hover,
        .stats-sub-page.active::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }

        .page-header {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .page-header-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            flex-shrink: 0;
        }

        .page-header-info h3 {
            font-size: 20px;
            color: #1f2937;
            margin: 0 0 4px 0;
            font-weight: 600;
        }

        .page-header-info p {
            color: #6b7280;
            margin: 0;
            font-size: 13px;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 15px;
            background: white;
        }

        .table-header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .table-header-left h4 {
            margin: 0;
            color: #1f2937;
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .table-header-left h4 i {
            color: #667eea;
            font-size: 18px;
        }

        .table-count {
            background: linear-gradient(135deg, #f0f0f0 0%, #e0e0e0 100%);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 13px;
            color: #666;
            font-weight: 500;
        }

        .btn-export {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .btn-export:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102,126,234,0.3);
        }

        .badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge.success {
            background: #d1fae5;
            color: #065f46;
        }

        .badge.warning {
            background: #fed7aa;
            color: #92400e;
        }

        /* 增强统计卡片样式 */
        .stats-grid .stat-card {
            position: relative;
            overflow: hidden;
        }

        .stats-grid .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, rgba(102,126,234,0.08) 0%, rgba(118,75,162,0.08) 100%);
            border-radius: 0 12px 0 100%;
        }

        .stat-icon {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
        }

        /* 为不同卡片的图标设置不同的渐变色 */
        .stats-grid .stat-card:nth-child(1) .stat-icon {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(102,126,234,0.3);
        }

        .stats-grid .stat-card:nth-child(2) .stat-icon {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(240,147,251,0.3);
        }

        .stats-grid .stat-card:nth-child(3) .stat-icon {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(79,172,254,0.3);
        }

        .stats-grid .stat-card:nth-child(4) .stat-icon {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(67,233,123,0.3);
        }

        .stat-title {
            position: relative;
            z-index: 1;
        }

        .stat-value {
            position: relative;
            z-index: 1;
        }

        .stat-trend {
            position: relative;
            z-index: 1;
        }

        .stat-trend.up {
            color: #10b981;
        }

        .stat-trend.down {
            color: #ef4444;
        }

        /* 图表容器增强 */
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .chart-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-title i {
            font-size: 18px;
            color: #667eea;
        }

        /* 统计概览页面专用样式 - 现代化美化版本 */
        .overview-top-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
            margin-bottom: 28px;
            animation: fadeInUp 0.6s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .overview-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.08), 0 1px 3px rgba(0,0,0,0.05);
            border: 1px solid rgba(102, 126, 234, 0.08);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .overview-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .overview-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(102, 126, 234, 0.15), 0 2px 6px rgba(0,0,0,0.08);
        }

        .overview-card:hover::before {
            opacity: 1;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 2px solid rgba(102, 126, 234, 0.08);
            position: relative;
        }

        .card-header::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 60px;
            height: 2px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        }

        .card-header h4 {
            margin: 0;
            font-size: 16px;
            color: #1a1a1a;
            font-weight: 700;
            letter-spacing: -0.02em;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .view-details, .view-more {
            font-size: 13px;
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            padding-right: 4px;
        }

        .view-details:hover, .view-more:hover {
            color: #764ba2;
            transform: translateX(4px);
        }

        .filter-row {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: #666;
        }

        .small-select {
            padding: 4px 8px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 13px;
        }

        .smart-stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 14px;
            margin-top: 18px;
        }

        .smart-stat-item {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.03) 0%, rgba(118, 75, 162, 0.05) 100%);
            padding: 18px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(102, 126, 234, 0.08);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .smart-stat-item:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.12);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.1) 100%);
        }

        .stat-number {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            letter-spacing: -0.04em;
            animation: countUp 0.6s ease-out;
        }

        @keyframes countUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .stat-label {
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }

        .stat-sublabel {
            font-size: 11px;
            color: #999;
            margin-top: 4px;
            font-weight: 500;
        }

        .device-fault-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding: 12px 16px;
            background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%);
            border-radius: 8px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }
        
        .device-fault-info .device-count {
            font-size: 14px;
            color: #666;
        }
        
        .device-fault-info .device-count strong {
            font-size: 18px;
            color: #667eea;
            font-weight: 600;
            margin-left: 4px;
        }
        
        .device-fault-info .fault-rate {
            font-size: 14px;
            color: #666;
        }
        
        .device-fault-info .fault-rate strong {
            font-size: 18px;
            font-weight: 600;
            margin-left: 4px;
        }

        .donut-chart-container {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .donut-chart {
            flex-shrink: 0;
        }

        .chart-legend {
            flex: 1;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 13px;
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .legend-text {
            color: #666;
        }

        .legend-value {
            color: #1a1a1a;
            font-weight: 600;
        }

        .alert-number {
            font-size: 48px;
            font-weight: 800;
            background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
            margin: 20px 0;
            letter-spacing: -0.04em;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        .mini-chart-container {
            height: 100px;
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.05) 0%, rgba(239, 68, 68, 0.08) 100%);
            border-radius: 12px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px dashed rgba(245, 158, 11, 0.2);
        }

        .mini-chart-placeholder i {
            font-size: 40px;
            color: rgba(245, 158, 11, 0.3);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .alert-indicators {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .alert-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .alert-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .alert-badge.critical {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            color: #991b1b;
            border: 1px solid rgba(153, 27, 27, 0.2);
        }

        .alert-badge.warning {
            background: linear-gradient(135deg, #fed7aa 0%, #fdba74 100%);
            color: #92400e;
            border: 1px solid rgba(146, 64, 14, 0.2);
        }

        .alert-badge.info {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            color: #1e40af;
            border: 1px solid rgba(30, 64, 175, 0.2);
        }

        .no-data-placeholder {
            text-align: center;
            padding: 20px;
            color: #999;
        }

        .no-data-placeholder i {
            font-size: 32px;
            margin-bottom: 8px;
            opacity: 0.3;
        }

        .no-data-placeholder p {
            margin: 0;
            font-size: 13px;
        }

        .device-status-section {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 28px;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.08), 0 1px 3px rgba(0,0,0,0.05);
            border: 1px solid rgba(102, 126, 234, 0.08);
            animation: fadeInUp 0.7s ease-out;
            transition: all 0.4s ease;
        }

        .device-status-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.12), 0 2px 6px rgba(0,0,0,0.08);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 2px solid rgba(102, 126, 234, 0.08);
            position: relative;
        }

        .section-header::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 60px;
            height: 2px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        }

        .section-header h4 {
            margin: 0;
            font-size: 16px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .device-status-list {
            display: flex;
            gap: 40px;
            justify-content: center;
        }

        .device-status-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            padding: 16px;
            border-radius: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .device-status-item:hover {
            background: rgba(102, 126, 234, 0.05);
            transform: translateY(-4px);
        }

        .status-icon-circle {
            width: 72px;
            height: 72px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ccfbf1 0%, #99f6e4 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: #14b8a6;
            box-shadow: 0 4px 16px rgba(20, 184, 166, 0.2);
            transition: all 0.3s ease;
        }

        .device-status-item:hover .status-icon-circle {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 8px 24px rgba(20, 184, 166, 0.3);
        }

        .stats-section-title {
            font-size: 14px;
            color: #666;
            margin: 16px 0 12px 0;
            font-weight: 500;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #10b981;
        }

        .status-text {
            font-size: 12px;
            color: #10b981;
            font-weight: 600;
        }

        .device-label {
            font-size: 13px;
            color: #666;
        }

        .device-detail-cards {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
            animation: fadeInUp 0.8s ease-out;
        }

        .device-detail-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.08), 0 1px 3px rgba(0,0,0,0.05);
            border: 1px solid rgba(102, 126, 234, 0.08);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .device-detail-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .device-detail-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(102, 126, 234, 0.15), 0 2px 6px rgba(0,0,0,0.08);
        }

        .device-detail-card:hover::before {
            opacity: 1;
        }

        .detail-card-header {
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 2px solid rgba(102, 126, 234, 0.08);
            position: relative;
        }

        .detail-card-header::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 50px;
            height: 2px;
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
        }

        .detail-card-header h5 {
            margin: 0;
            font-size: 16px;
            font-weight: 700;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .detail-stats-row {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .detail-stat-item {
            flex: 1;
            min-width: 100px;
            text-align: center;
            padding: 14px 8px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.03) 0%, rgba(5, 150, 105, 0.05) 100%);
            border-radius: 10px;
            border: 1px solid rgba(16, 185, 129, 0.1);
            transition: all 0.3s ease;
        }

        .detail-stat-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.15);
        }

        .detail-stat-item.status-normal {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            color: #065f46;
            font-weight: 700;
            font-size: 14px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            border: 1px solid rgba(6, 95, 70, 0.2);
        }

        .detail-stat-item .stat-value {
            font-size: 26px;
            font-weight: 800;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 4px;
        }

        .detail-stat-item .stat-desc {
            font-size: 11px;
            color: #666;
            line-height: 1.4;
            font-weight: 500;
        }

        .detail-charts-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 14px;
        }

        .detail-mini-chart {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.03) 0%, rgba(5, 150, 105, 0.05) 100%);
            padding: 18px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(16, 185, 129, 0.1);
            transition: all 0.3s ease;
        }

        .detail-mini-chart:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.12);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.08) 0%, rgba(5, 150, 105, 0.1) 100%);
        }

        .detail-mini-chart .chart-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .detail-mini-chart .chart-number {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.02em;
        }

        .filter-select, .filter-input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            outline: none;
            transition: all 0.3s;
        }

        .filter-select {
            min-width: 150px;
        }

        .filter-input {
            min-width: 200px;
        }

        .filter-select:focus, .filter-input:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .btn-new {
            padding: 10px 20px;
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            margin-left: auto;
        }

        .btn-new:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        /* 数据表格 */
        .data-table-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            overflow: hidden;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table thead {
            background: #f8f9fa;
        }

        .data-table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #555;
            font-size: 14px;
            border-bottom: 2px solid #e9ecef;
        }

        .data-table td {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 14px;
            color: #666;
        }

        .data-table tbody tr {
            transition: all 0.3s;
        }

        .data-table tbody tr:hover {
            background: #f8f9fa;
        }

        /* 状态标签 */
        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-badge.active {
            background: #d4edda;
            color: #28a745;
        }

        .status-badge.active::before {
            content: '●';
            margin-right: 5px;
        }

        /* 操作按钮 */
        .action-btns {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .btn-action {
            padding: 5px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .btn-action.enable {
            background: #3498db;
            color: white;
        }

        .btn-action.enable:hover {
            background: #2980b9;
        }

        .btn-action.edit {
            background: #f39c12;
            color: white;
        }

        .btn-action.edit:hover {
            background: #e67e22;
        }

        .btn-action.delete {
            background: #e74c3c;
            color: white;
        }

        .btn-action.delete:hover {
            background: #c0392b;
        }

        .btn-action.config {
            background: #9b59b6;
            color: white;
        }

        .btn-action.config:hover {
            background: #8e44ad;
        }

        /* 统计卡片 */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(102,126,234,0.2);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .stat-title {
            font-size: 14px;
            color: #999;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: #333;
            margin-bottom: 8px;
        }

        .stat-trend {
            font-size: 13px;
            color: #28a745;
        }

        /* 图表容器 */
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
        }

        .chart-placeholder {
            height: 300px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 14px;
        }

        /* 分页 */
        .pagination {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            border-top: 1px solid #f0f0f0;
        }

        .pagination-info {
            color: #666;
            font-size: 14px;
        }

        .pagination-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .page-btn {
            width: 32px;
            height: 32px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .page-btn:hover {
            border-color: #3498db;
            color: #3498db;
        }

        .page-input {
            width: 50px;
            padding: 6px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        /* 预测报告页面样式 */
        .report-layout {
            display: flex;
            height: 100%;
            background: white;
        }

        .report-sidebar {
            width: 200px;
            background: #fafafa;
            border-right: 1px solid #e4e7ed;
            padding: 10px 0;
            overflow-y: auto;
        }

        .sidebar-category {
            padding: 12px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            color: #606266;
            transition: all 0.3s;
        }

        .sidebar-category:hover {
            background: #f0f2f5;
            color: #409eff;
        }

        .sidebar-category.active {
            background: #ecf5ff;
            color: #409eff;
            font-weight: 600;
        }

        .category-text {
            flex: 1;
        }

        .category-count {
            color: #909399;
            font-size: 12px;
        }

        .report-main {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .report-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f9fafb;
            border-radius: 4px;
        }

        .toolbar-left, .toolbar-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toolbar-select {
            padding: 6px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            background: white;
            cursor: pointer;
        }

        .time-input {
            width: 60px;
            padding: 6px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            text-align: center;
        }

        .btn-close-toolbar {
            width: 28px;
            height: 28px;
            border: none;
            background: #f5f7fa;
            border-radius: 4px;
            cursor: pointer;
            font-size: 18px;
            color: #909399;
            transition: all 0.3s;
        }

        .btn-close-toolbar:hover {
            background: #e4e7ed;
            color: #606266;
        }

        .status-toggle-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .status-btn {
            padding: 8px 24px;
            border: 1px solid #dcdfe6;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            color: #606266;
            transition: all 0.3s;
        }

        .status-btn:hover {
            border-color: #409eff;
            color: #409eff;
        }

        .status-btn.active {
            background: #409eff;
            border-color: #409eff;
            color: white;
        }

        .report-chart-container {
            height: 400px;
            background: white;
            border: 1px solid #e4e7ed;
            border-radius: 4px;
            padding: 20px;
        }

        /* 预训风险页面样式 */
        .risk-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: white;
            border-bottom: 1px solid #e4e7ed;
            margin-bottom: 20px;
        }

        .toolbar-filters {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .filter-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-item label {
            font-size: 14px;
            color: #606266;
            white-space: nowrap;
        }

        .filter-select {
            padding: 6px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            background: white;
            font-size: 14px;
            cursor: pointer;
            min-width: 120px;
        }

        .search-input {
            padding: 6px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            width: 200px;
            font-size: 14px;
        }

        .btn-search {
            padding: 8px 20px;
            border: none;
            background: #409eff;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .btn-search:hover {
            background: #66b1ff;
        }

        .btn-history {
            padding: 8px 20px;
            border: 1px solid #409eff;
            background: white;
            color: #409eff;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .btn-history:hover {
            background: #ecf5ff;
        }

        .risk-table-container {
            background: white;
            border-radius: 4px;
            overflow: hidden;
        }

        .risk-table {
            width: 100%;
            border-collapse: collapse;
        }

        .risk-table thead {
            background: #f5f7fa;
        }

        .risk-table th {
            padding: 12px 16px;
            text-align: left;
            font-size: 14px;
            font-weight: 600;
            color: #606266;
            border-bottom: 1px solid #e4e7ed;
        }

        .risk-table td {
            padding: 12px 16px;
            font-size: 14px;
            color: #606266;
            border-bottom: 1px solid #f0f2f5;
        }

        .risk-table tbody tr:hover {
            background: #f5f7fa;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
        }

        .empty-state i {
            font-size: 64px;
            color: #dcdfe6;
            margin-bottom: 16px;
        }

        .empty-state p {
            font-size: 14px;
            color: #909399;
            margin: 0;
        }

        /* 智能分析页面样式 */
        .analysis-layout {
            display: flex;
            height: 100%;
            background: white;
        }

        .analysis-main {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .analysis-chart-container {
            height: 300px;
            background: white;
            border: 1px solid #e4e7ed;
            border-radius: 4px;
            margin-bottom: 20px;
            padding: 20px;
        }

        .time-range-selector {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background: #f9fafb;
            border-radius: 4px;
            margin-bottom: 20px;
        }

        .time-range-input {
            padding: 6px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            width: 200px;
        }

        .time-value-input {
            width: 80px;
            padding: 6px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            text-align: center;
        }

        .btn-query {
            padding: 8px 24px;
            border: none;
            background: #409eff;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .btn-query:hover {
            background: #66b1ff;
        }

        .analysis-table-container {
            background: white;
            border-radius: 4px;
            overflow-x: auto;
        }

        .analysis-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }

        .analysis-table thead {
            background: #f5f7fa;
        }

        .analysis-table th {
            padding: 12px 10px;
            text-align: left;
            font-size: 13px;
            font-weight: 600;
            color: #606266;
            border-bottom: 1px solid #e4e7ed;
            white-space: nowrap;
        }

        .analysis-table td {
            padding: 12px 10px;
            font-size: 13px;
            color: #606266;
            border-bottom: 1px solid #f0f2f5;
        }

        .analysis-sidebar {
            width: 250px;
            background: #fafafa;
            border-left: 1px solid #e4e7ed;
            padding: 20px;
        }

        .sidebar-section {
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: #606266;
            margin-bottom: 12px;
        }

        .sidebar-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            font-size: 14px;
        }

        .section-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: white;
            border-radius: 4px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .section-item:hover {
            background: #ecf5ff;
            color: #409eff;
        }

        .section-item i {
            font-size: 16px;
        }

        /* 算法模型服务页面样式 */
        .model-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: white;
            border-bottom: 1px solid #e4e7ed;
            margin-bottom: 20px;
        }

        .toolbar-left-filters {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .model-input, .model-search {
            padding: 6px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            font-size: 14px;
        }

        .model-input {
            width: 150px;
        }

        .model-search {
            width: 180px;
        }

        .model-select {
            padding: 6px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            background: white;
            font-size: 14px;
            cursor: pointer;
            min-width: 140px;
        }

        .btn-model-search {
            width: 36px;
            height: 32px;
            border: none;
            background: #409eff;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-model-search:hover {
            background: #66b1ff;
        }

        .btn-new-model {
            padding: 8px 20px;
            border: none;
            background: #409eff;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .btn-new-model:hover {
            background: #66b1ff;
        }

        .model-table-container {
            background: white;
            border-radius: 4px;
            overflow-x: auto;
        }

        .model-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1200px;
        }

        .model-table thead {
            background: #f5f7fa;
        }

        .model-table th {
            padding: 12px 16px;
            text-align: left;
            font-size: 14px;
            font-weight: 600;
            color: #606266;
            border-bottom: 1px solid #e4e7ed;
        }

        .model-table td {
            padding: 12px 16px;
            font-size: 14px;
            color: #606266;
            border-bottom: 1px solid #f0f2f5;
        }

        .model-table tbody tr:hover {
            background: #f5f7fa;
        }

        .model-status {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 13px;
        }

        .model-status.enabled {
            background: #e1f3d8;
            color: #67c23a;
        }

        .status-select {
            padding: 4px 8px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            background: white;
            font-size: 13px;
            cursor: pointer;
        }

        .model-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .btn-link {
            padding: 4px 8px;
            border: none;
            background: none;
            color: #409eff;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s;
        }

        .btn-link:hover {
            color: #66b1ff;
            text-decoration: underline;
        }

        .model-pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-top: 1px solid #e4e7ed;
        }

        .model-pagination .pagination-info {
            font-size: 14px;
            color: #606266;
        }

        .model-pagination .pagination-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- 侧边栏 -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>人工智能运维平台</h2>
            </div>
            <div class="sidebar-item nav-overview">
                <i class="fas fa-tachometer-alt"></i>
                <span>总览</span>
            </div>
            <div class="sidebar-item nav-view">
                <i class="fas fa-eye"></i>
                <span>视图</span>
            </div>
            <div class="sidebar-item nav-alert">
                <i class="fas fa-bell"></i>
                <span>告警中心</span>
            </div>
            <div class="sidebar-item nav-device">
                <i class="fas fa-server"></i>
                <span>设备管理</span>
            </div>
            <div class="sidebar-item nav-network">
                <i class="fas fa-network-wired"></i>
                <span>网络拓扑</span>
            </div>
            <div class="sidebar-item nav-report">
                <i class="fas fa-chart-line"></i>
                <span>统计报表</span>
            </div>
            <div class="sidebar-item nav-tools">
                <i class="fas fa-tools"></i>
                <span>运维工具</span>
            </div>
            <div class="sidebar-divider"></div>
            <div class="sidebar-group-title">拓展中心</div>
            <div class="sidebar-item nav-business">
                <i class="fas fa-layer-group"></i>
                <span>业务管理</span>
            </div>
            <div class="sidebar-item nav-network-mgmt">
                <i class="fas fa-globe"></i>
                <span>网络管理</span>
            </div>
            <div class="sidebar-item nav-video">
                <i class="fas fa-video"></i>
                <span>视频管理</span>
            </div>
            <div class="sidebar-item nav-room">
                <i class="fas fa-building"></i>
                <span>机房管理</span>
            </div>
            <div class="sidebar-item nav-asset">
                <i class="fas fa-cubes"></i>
                <span>资产管理</span>
            </div>
            <div class="sidebar-item nav-operation">
                <i class="fas fa-user-cog"></i>
                <span>运维管理</span>
            </div>
            <div class="sidebar-item nav-cmdb">
                <i class="fas fa-database"></i>
                <span>CMDB</span>
            </div>
            <div class="sidebar-item nav-log">
                <i class="fas fa-file-alt"></i>
                <span>日志管理</span>
            </div>
            <div class="sidebar-item nav-prediction active">
                <i class="fas fa-chart-pie"></i>
                <span>智能预测管理</span>
            </div>
            <div class="sidebar-item nav-cloud">
                <i class="fas fa-cloud"></i>
                <span>云平台</span>
            </div>
            <div class="sidebar-divider"></div>
            <div class="sidebar-group-title">设置中心</div>
            <div class="sidebar-item nav-settings">
                <i class="fas fa-cog"></i>
                <span>设置</span>
            </div>
            <div class="sidebar-item nav-docking">
                <i class="fas fa-plug"></i>
                <span>对接配置</span>
            </div>
        </div>

        <!-- 主内容区 -->
        <div class="main-content">
            <!-- 顶部导航栏 -->
            <header class="top-header">
                <div class="header-left">
                    <div class="breadcrumb">
                        <span class="breadcrumb-item">智能预测管理</span>
                        <span class="breadcrumb-separator">/</span>
                        <span class="breadcrumb-item" id="currentSubPage">算法模型服务</span>
                    </div>
                </div>
                <div class="header-right">
                    <!-- 用户下拉菜单容器 -->
                    <div id="user-dropdown-container"></div>
                </div>
            </header>

            <!-- 页面内容 -->
            <div class="page-content">
                <!-- 智能预测管理内容区域 -->
                <div class="prediction-container">
                    <!-- 左侧预测分类树 -->
                    <div class="prediction-tree">
                        <div class="tree-header">
                            <h3>智能预测管理</h3>
                        </div>
                        <div class="tree-content">
                            <div class="tree-node has-children">
                                <div class="node-item parent-node" data-page="stats">
                                    <i class="fas fa-chevron-right expand-icon"></i>
                                    <i class="fas fa-chart-pie node-icon"></i>
                                    <span class="node-text">智能统计</span>
                                </div>
                                <div class="sub-nodes">
                                    <div class="node-item sub-node" data-sub-page="stats-overview">
                                        <i class="fas fa-chart-bar node-icon"></i>
                                        <span class="node-text">概览</span>
                                    </div>
                                    <div class="node-item sub-node" data-sub-page="stats-report">
                                        <i class="fas fa-file-alt node-icon"></i>
                                        <span class="node-text">预测报告</span>
                                    </div>
                                    <div class="node-item sub-node" data-sub-page="stats-risk">
                                        <i class="fas fa-exclamation-triangle node-icon"></i>
                                        <span class="node-text">预测风险</span>
                                    </div>
                                </div>
                            </div>
                            <div class="tree-node">
                                <div class="node-item" data-page="analysis">
                                    <i class="fas fa-brain node-icon"></i>
                                    <span class="node-text">智能分析</span>
                                </div>
                            </div>
                            <div class="tree-node">
                                <div class="node-item selected" data-page="model-service">
                                    <i class="fas fa-server node-icon"></i>
                                    <span class="node-text">算法模型服务</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 右侧主要内容区域 -->
                    <div class="prediction-main">
                        <!-- 智能统计页面 -->
                        <div class="sub-page" id="page-stats">
                            <!-- 统计概览子页面 -->
                            <div class="stats-sub-page active" id="page-stats-overview">
                                <!-- 顶部三列布局 -->
                                <div class="overview-top-row">
                                    <!-- 左侧：按设备分类统计 -->
                                    <div class="overview-card">
                                        <div class="card-header">
                                            <h4>按设备分类统计</h4>
                                            <div class="stats-filter">
                                                <label>预测时间</label>
                                                <select class="time-select" id="predictionTimeSelect" onchange="onPredictionTimeChange()">
                                                    <option value="1" selected>1</option>
                                                    <option value="7">7</option>
                                                    <option value="30">30</option>
                                                </select>
                                                <span>天</span>
                                            </div>
                                        </div>
                                        <div class="stats-section-title">智能分析能力统计</div>
                                        <div class="smart-stats-grid">
                                            <div class="smart-stat-item">
                                                <div class="stat-number" id="totalTrainingObjects">0</div>
                                                <div class="stat-label">总训练对象</div>
                                            </div>
                                            <div class="smart-stat-item">
                                                <div class="stat-number" id="enabledStrategies">2</div>
                                                <div class="stat-label">智能策略</div>
                                                <div class="stat-sublabel">启用：<span id="enabledStrategiesLabel">2</span></div>
                                            </div>
                                            <div class="smart-stat-item">
                                                <div class="stat-number" id="totalTrainingModels">0</div>
                                                <div class="stat-label">总训练模型数</div>
                                            </div>
                                            <div class="smart-stat-item">
                                                <div class="stat-number" id="totalTrainingRecords">0</div>
                                                <div class="stat-label">总训练次数</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 中间：各设备故障占比 -->
                                    <div class="overview-card">
                                        <div class="card-header">
                                            <h4>各设备故障占比</h4>
                                            <a href="#" class="view-details" onclick="switchStatsSubPage('stats-report'); return false;">查看预测报告 ></a>
                                        </div>
                                        <div class="device-fault-info">
                                            <span class="device-count">设备总数: <strong class="device-total-count">0</strong></span>
                                            <span class="fault-rate">设备故障率: <strong style="color: #10b981;">0%</strong></span>
                                        </div>
                                        <div class="donut-chart-container">
                                            <div class="donut-chart" id="deviceFaultPieChart" style="width: 100%; height: 280px;"></div>
                                        </div>
                                    </div>

                                    <!-- 右侧：预测告警 -->
                                    <div class="overview-card">
                                        <div class="card-header">
                                            <h4>预测告警</h4>
                                            <a href="#" class="view-more" onclick="switchStatsSubPage('stats-risk'); return false;">更多 ></a>
                                        </div>
                                        <div class="alert-number" id="totalAlerts">0</div>
                                        <div class="mini-chart-container">
                                            <div class="mini-chart-placeholder">
                                                <i class="fas fa-chart-line"></i>
                                            </div>
                                        </div>
                                        <div class="alert-indicators">
                                            <span class="alert-badge critical">
                                                <i class="fas fa-exclamation-triangle"></i> <span id="criticalCount">0</span>
                                            </span>
                                            <span class="alert-badge warning">
                                                <i class="fas fa-exclamation-circle"></i> <span id="warningCount">0</span>
                                            </span>
                                            <span class="alert-badge info">
                                                <i class="fas fa-info-circle"></i> <span id="infoCount">0</span>
                                            </span>
                                        </div>
                                        <div class="no-data-placeholder">
                                            <i class="fas fa-database"></i>
                                            <p>暂无数据</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- 设备分类故障率 -->
                                <div class="device-status-section">
                                    <div class="section-header">
                                        <h4>设备分类故障率</h4>
                                        <a href="#" class="view-more" onclick="switchStatsSubPage('stats-risk'); return false;">更多 ></a>
                                    </div>
                                    <div class="device-status-list" id="categoryFaultList">
                                        <!-- 分类故障率列表将由JavaScript动态生成 -->
                                        <div class="loading-placeholder">加载中...</div>
                                    </div>
                                </div>

                                <!-- 底部两个设备类型的详细统计卡片 -->
                                <div class="device-detail-cards">
                                    <!-- 服务器故障预测 -->
                                    <div class="device-detail-card">
                                        <div class="detail-card-header">
                                            <h5>服务器故障预测</h5>
                                        </div>
                                        <div class="detail-stats-row">
                                            <div class="detail-stat-item status-normal">
                                                <i class="fas fa-check-circle"></i>
                                                <span class="status-label">正常</span>
                                            </div>
                                            <div class="detail-stat-item">
                                                <div class="stat-value">1</div>
                                                <div class="stat-desc">总训练设备总数</div>
                                            </div>
                                            <div class="detail-stat-item">
                                                <div class="stat-value">0</div>
                                                <div class="stat-desc">选基次数</div>
                                            </div>
                                            <div class="detail-stat-item">
                                                <div class="stat-value">0</div>
                                                <div class="stat-desc">自动预测故障设备数</div>
                                            </div>
                                            <div class="detail-stat-item">
                                                <div class="stat-value">0</div>
                                                <div class="stat-desc">存在预测预故障设备数</div>
                                            </div>
                                        </div>
                                        <div class="detail-charts-row">
                                            <div class="detail-mini-chart">
                                                <div class="chart-label">预测间隔最多的设备</div>
                                                <div class="chart-number">1</div>
                                            </div>
                                            <div class="detail-mini-chart">
                                                <div class="chart-label">预测间隔最多的指标</div>
                                                <div class="chart-number">1</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 其他故障预测 -->
                                    <div class="device-detail-card">
                                        <div class="detail-card-header">
                                            <h5>其他故障预测</h5>
                                        </div>
                                        <div class="detail-stats-row">
                                            <div class="detail-stat-item status-normal">
                                                <i class="fas fa-check-circle"></i>
                                                <span class="status-label">正常</span>
                                            </div>
                                            <div class="detail-stat-item">
                                                <div class="stat-value">1</div>
                                                <div class="stat-desc">总训练设备总数</div>
                                            </div>
                                            <div class="detail-stat-item">
                                                <div class="stat-value">0</div>
                                                <div class="stat-desc">选基次数</div>
                                            </div>
                                            <div class="detail-stat-item">
                                                <div class="stat-value">0</div>
                                                <div class="stat-desc">自动预测故障设备数</div>
                                            </div>
                                            <div class="detail-stat-item">
                                                <div class="stat-value">0</div>
                                                <div class="stat-desc">存在预测预故障设备数</div>
                                            </div>
                                        </div>
                                        <div class="detail-charts-row">
                                            <div class="detail-mini-chart">
                                                <div class="chart-label">预测间隔最多的设备</div>
                                                <div class="chart-number">1</div>
                                            </div>
                                            <div class="detail-mini-chart">
                                                <div class="chart-label">预测间隔最多的指标</div>
                                                <div class="chart-number">1</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 预测报告子页面 -->
                            <div class="stats-sub-page" id="page-stats-report">
                                <div class="report-layout">
                                    <!-- 左侧分类菜单 -->
                                    <div class="report-sidebar">
                                        <div class="sidebar-category">
                                            <span class="category-text">当前分类</span>
                                        </div>
                                        <div class="sidebar-category">
                                            <span class="category-text">设备类别2</span>
                                            <span class="category-count">(1)</span>
                                        </div>
                                        <div class="sidebar-category">
                                            <span class="category-text">应用范式业务</span>
                                        </div>
                                        <div class="sidebar-category">
                                            <span class="category-text">应用运维业务</span>
                                        </div>
                                        <div class="sidebar-category">
                                            <span class="category-text">安全运维</span>
                                        </div>
                                        <div class="sidebar-category">
                                            <span class="category-text">可用性监</span>
                                            <span class="category-count">(1)</span>
                                        </div>
                                        <div class="sidebar-category">
                                            <span class="category-text">物联网</span>
                                        </div>
                                        <div class="sidebar-category">
                                            <span class="category-text">其他</span>
                                            <span class="category-count">(1)</span>
                                        </div>
                                    </div>

                                    <!-- 右侧主内容区 -->
                                    <div class="report-main">
                                        <!-- 顶部工具栏 -->
                                        <div class="report-toolbar">
                                            <div class="toolbar-left">
                                                <label>品牌</label>
                                                <select class="toolbar-select">
                                                    <option>全部</option>
                                                </select>
                                            </div>
                                            <div class="toolbar-right">
                                                <span>预测时间：</span>
                                                <input type="number" class="time-input" value="1" min="1" />
                                                <span>天</span>
                                                <button class="btn-close-toolbar">×</button>
                                            </div>
                                        </div>

                                        <!-- 状态切换 -->
                                        <div class="status-toggle-bar">
                                            <button class="status-btn active" data-status="normal">正常</button>
                                            <button class="status-btn" data-status="abnormal">异常</button>
                                        </div>

                                        <!-- 图表区域 -->
                                        <div class="report-chart-container">
                                            <div class="chart-placeholder">
                                                <i class="fas fa-chart-line"></i>
                                                <p>按模型执分类年号使用分布</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 预测风险子页面 -->
                            <div class="stats-sub-page" id="page-stats-risk">
                                <!-- 顶部工具栏 -->
                                <div class="risk-toolbar">
                                    <div class="toolbar-filters">
                                        <div class="filter-item">
                                            <label>预测时间：</label>
                                            <select class="filter-select">
                                                <option>1</option>
                                                <option>7</option>
                                                <option>30</option>
                                            </select>
                                            <span>天</span>
                                        </div>
                                        <div class="filter-item">
                                            <select class="filter-select">
                                                <option>全部风险时区</option>
                                                <option>高风险</option>
                                                <option>中风险</option>
                                                <option>低风险</option>
                                            </select>
                                        </div>
                                        <div class="filter-item">
                                            <select class="filter-select">
                                                <option>全部监控类别</option>
                                                <option>设备监控</option>
                                                <option>应用监控</option>
                                                <option>网络监控</option>
                                            </select>
                                        </div>
                                        <div class="filter-item">
                                            <input type="text" class="search-input" placeholder="输入关键字" />
                                        </div>
                                        <button class="btn-search">
                                            <i class="fas fa-search"></i> 搜索
                                        </button>
                                    </div>
                                    <div class="toolbar-actions">
                                        <button class="btn-history">预训风险历史</button>
                                    </div>
                                </div>

                                <!-- 数据表格 -->
                                <div class="risk-table-container">
                                    <table class="risk-table">
                                        <thead>
                                            <tr>
                                                <th>状态</th>
                                                <th>延时快捷</th>
                                                <th>最近风险时间</th>
                                                <th>风险描述</th>
                                                <th>生成时间</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- 空状态 -->
                                            <tr class="empty-row">
                                                <td colspan="5">
                                                    <div class="empty-state">
                                                        <i class="fas fa-inbox"></i>
                                                        <p>暂无数据</p>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- 智能分析页面 -->
                        <div class="sub-page" id="page-analysis">
                            <div class="analysis-layout">
                                <!-- 主内容区 -->
                                <div class="analysis-main">
                                    <!-- 顶部折线图 -->
                                    <div class="analysis-chart-container">
                                        <div class="chart-placeholder">
                                            <i class="fas fa-chart-line"></i>
                                            <p>时间序列数据图表</p>
                                        </div>
                                    </div>

                                    <!-- 时间范围选择器 -->
                                    <div class="time-range-selector">
                                        <label>选择时间范围:</label>
                                        <input type="text" class="time-range-input" placeholder="2025-11-11 09:00" />
                                        <input type="number" class="time-value-input" value="50" />
                                        <span>分钟</span>
                                        <button class="btn-query">查询</button>
                                    </div>

                                    <!-- 数据表格 -->
                                    <div class="analysis-table-container">
                                        <table class="analysis-table">
                                            <thead>
                                                <tr>
                                                    <th>监测点名称/指标名称</th>
                                                    <th>设备名称</th>
                                                    <th>数据类型</th>
                                                    <th>选取值</th>
                                                    <th>平均值</th>
                                                    <th>最小值</th>
                                                    <th>最大值</th>
                                                    <th>求和值</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="empty-row">
                                                    <td colspan="8">
                                                        <div class="empty-state">
                                                            <i class="fas fa-inbox"></i>
                                                            <p>暂无数据</p>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- 右侧操作面板 -->
                                <div class="analysis-sidebar">
                                    <div class="sidebar-section">
                                        <div class="section-title">选择时段</div>
                                        <input type="text" class="sidebar-input" placeholder="搜索时段" />
                                    </div>
                                    <div class="sidebar-section">
                                        <div class="section-item">
                                            <i class="fas fa-chart-bar"></i>
                                            <span>发现新阈</span>
                                        </div>
                                        <div class="section-item">
                                            <i class="fas fa-chart-line"></i>
                                            <span>进阈阈调</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 算法模型服务页面 -->
                        <div class="sub-page active" id="page-model-service">
                            <!-- 顶部工具栏 -->
                            <div class="model-toolbar">
                                <div class="toolbar-left-filters">
                                    <input type="text" class="model-input" placeholder="算法服务名" />
                                    <select class="model-select">
                                        <option>运行状态方案</option>
                                        <option>启用</option>
                                        <option>停用</option>
                                    </select>
                                    <select class="model-select">
                                        <option>运行对象及监控</option>
                                        <option>所有设备</option>
                                        <option>服务器</option>
                                    </select>
                                    <input type="text" class="model-search" placeholder="请输入关键字" />
                                    <button class="btn-model-search">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </div>
                                <div class="toolbar-right-actions">
                                    <button class="btn-new-model">
                                        <i class="fas fa-plus"></i>
                                        新建算法模型服务
                                    </button>
                                </div>
                            </div>

                            <!-- 数据表格 -->
                            <div class="model-table-container">
                                <table class="model-table">
                                    <thead>
                                        <tr>
                                            <th>状态</th>
                                            <th>算法模型服务名</th>
                                            <th>预测方案</th>
                                            <th>训练对象</th>
                                            <th>全部状态</th>
                                            <th>更新时间</th>
                                            <th>计算方法</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><span class="model-status enabled">▶ 启用</span></td>
                                            <td>PropSet123对型</td>
                                            <td>对控读取数据</td>
                                            <td>所有加防</td>
                                            <td>
                                                <select class="status-select">
                                                    <option>全部状态</option>
                                                </select>
                                            </td>
                                            <td>2025-01-02 05:00:00</td>
                                            <td>Prophet</td>
                                            <td>
                                                <div class="model-actions">
                                                    <button class="btn-link">停用</button>
                                                    <button class="btn-link">设置预测策略</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><span class="model-status enabled">▶ 启用</span></td>
                                            <td>123</td>
                                            <td>对控读取数据</td>
                                            <td>CpuOS利用率</td>
                                            <td>
                                                <select class="status-select">
                                                    <option>0</option>
                                                </select>
                                            </td>
                                            <td>2025-11-05 23:07:52</td>
                                            <td>KNN-复数模拟交换序列</td>
                                            <td>
                                                <div class="model-actions">
                                                    <button class="btn-link">停用</button>
                                                    <button class="btn-link">编辑</button>
                                                    <button class="btn-link">删除</button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                                <!-- 分页器 -->
                                <div class="model-pagination">
                                    <div class="pagination-info">
                                        共计个条信，20条/页，第1页，总共1页
                                    </div>
                                    <div class="pagination-controls">
                                        <button class="page-btn">
                                            <i class="fas fa-angle-double-left"></i>
                                        </button>
                                        <button class="page-btn">
                                            <i class="fas fa-angle-left"></i>
                                        </button>
                                        <input type="text" class="page-input" value="1" />
                                        <button class="page-btn">
                                            <i class="fas fa-angle-right"></i>
                                        </button>
                                        <button class="page-btn">
                                            <i class="fas fa-angle-double-right"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 新建算法模型服务弹窗 -->
    <div class="model-service-modal" id="modelServiceModal">
        <div class="modal-content-model">
            <div class="modal-header-model">
                <h3 id="modelServiceModalTitle">新建算法模型服务</h3>
                <button class="modal-close-btn" onclick="closeModelServiceModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="modelServiceForm" class="modal-body-model">
                <input type="hidden" id="modelServiceId" name="id">
                
                <!-- 步骤1: 选择计算方式 -->
                <div class="form-step-model">
                    <div class="step-header-model">
                        <div class="step-number-model">1</div>
                        <h4 class="step-title-model">选择计算方式</h4>
                    </div>
                    <div class="step-content-model">
                        <div class="form-group-model">
                            <label>计算方法:</label>
                            <div class="algorithm-selection">
                                <div class="algorithm-option selected" data-value="KNN">
                                    <span class="algorithm-name">KNN多变量时间序列预测</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 步骤2: 选择数据源 -->
                <div class="form-step-model">
                    <div class="step-header-model">
                        <div class="step-number-model">2</div>
                        <h4 class="step-title-model">选择数据源</h4>
                    </div>
                    <div class="step-content-model">
                        <div class="data-source-section">
                            <div class="form-group-model">
                                <label>监控对象:</label>
                                <div class="form-row-model">
                                    <div class="form-col-model">
                                        <label class="sub-label">选择设备</label>
                                        <select id="deviceSelection" name="deviceSelection">
                                            <option value="">设备类型</option>
                                            <option value="server">服务器</option>
                                            <option value="network">网络设备</option>
                                            <option value="storage">存储设备</option>
                                        </select>
                                    </div>
                                    <div class="form-col-model">
                                        <input type="text" placeholder="请输入关键字搜索设备类型" class="search-input">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group-model">
                                <label>选择监控指标:</label>
                                <div class="form-row-model">
                                    <div class="form-col-model">
                                        <select id="metricCategory" name="metricCategory" onchange="updateSpecificMetrics()">
                                            <option value="">选择监控类型</option>
                                            <option value="cpu">CPU监控</option>
                                            <option value="memory">内存监控</option>
                                            <option value="disk">磁盘监控</option>
                                            <option value="network">网络监控</option>
                                            <option value="temperature">温度监控</option>
                                        </select>
                                    </div>
                                    <div class="form-col-model">
                                        <select id="specificMetric" name="specificMetric">
                                            <option value="">选择具体指标</option>
                                        </select>
                                    </div>
                                    <div class="form-col-model">
                                        <input type="text" placeholder="选择指标" class="metric-input">
                                        <button type="button" class="add-metric-btn">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                <!-- 步骤3: 配置模型参数 -->
                <div class="form-step-model">
                    <div class="step-header-model">
                        <div class="step-number-model">3</div>
                        <h4 class="step-title-model">配置模型参数</h4>
                    </div>
                    <div class="step-content-model">
                        <div class="form-group-model">
                            <label>模型训练参数:</label>
                            <div class="form-row-model">
                                <div class="form-col-model">
                                    <label class="sub-label">模型更新周期:</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="updateCycle" name="updateCycle" value="7" min="1">
                                        <span class="unit">天</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 步骤4: 配置预测策略 -->
                <div class="form-step-model">
                    <div class="step-header-model">
                        <div class="step-number-model">4</div>
                        <h4 class="step-title-model">配置预测策略</h4>
                    </div>
                    <div class="step-content-model">
                        <div class="form-group-model">
                            <label>自动预测:</label>
                            <div class="toggle-switch">
                                <input type="checkbox" id="autoPrediction" name="autoPrediction" checked>
                                <label for="autoPrediction" class="toggle-label"></label>
                            </div>
                        </div>
                        
                        <div class="form-group-model">
                            <label>预测周期时间:</label>
                            <div class="form-row-model">
                                <div class="form-col-model">
                                    <div class="input-with-unit">
                                        <input type="number" id="predictionCycle" name="predictionCycle" value="1" min="1">
                                        <span class="unit">天</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group-model">
                            <label>预测时长:</label>
                            <div class="form-row-model">
                                <div class="form-col-model">
                                    <div class="input-with-unit">
                                        <input type="number" id="predictionDuration" name="predictionDuration" value="1" min="1">
                                        <span class="unit">天</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 步骤5: 基本信息 -->
                <div class="form-step-model">
                    <div class="step-header-model">
                        <div class="step-number-model">5</div>
                        <h4 class="step-title-model">基本信息</h4>
                    </div>
                    <div class="step-content-model">
                        <div class="form-group-model">
                            <label>算法模型服务名称:</label>
                            <input type="text" id="serviceName" name="serviceName" placeholder="" required>
                        </div>
                        
                        <div class="form-group-model">
                            <label>备注</label>
                            <textarea id="serviceNotes" name="serviceNotes" placeholder="" rows="4"></textarea>
                        </div>
                    </div>
                </div>
            </form>
            
            <div class="modal-footer-model">
                <button type="button" class="btn-cancel-model" onclick="closeModelServiceModal()">取消</button>
                <button type="button" class="btn-save-model" onclick="saveModelService()">保存</button>
            </div>
        </div>
    </div>

    <script src="js/navigation-fix.js"></script>
    <script src="js/user-dropdown-loader.js"></script>
    <script>
        // 子页面切换功能
        function switchSubPage(pageName) {
            // 隐藏所有子页面
            document.querySelectorAll('.sub-page').forEach(page => {
                page.classList.remove('active');
            });
            
            // 显示目标页面
            const targetPage = document.getElementById('page-' + pageName);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // 更新树形菜单选中状态
            document.querySelectorAll('.node-item').forEach(item => {
                item.classList.remove('selected');
            });
            document.querySelector(`.node-item[data-page="${pageName}"]`)?.classList.add('selected');
            
            // 更新面包屑
            const pageNames = {
                'stats': '智能统计',
                'analysis': '智能分析',
                'model-service': '算法模型服务'
            };
            document.getElementById('currentSubPage').textContent = pageNames[pageName] || '算法模型服务';
        }

        // 使用事件委托绑定树形菜单点击事件（避免重复绑定）
        let isProcessingClick = false; // 防抖标志
        
        document.querySelector('.tree-content')?.addEventListener('click', function(e) {
            // 查找最近的.node-item元素
            const nodeItem = e.target.closest('.node-item');
            if (!nodeItem || isProcessingClick) return;
            
            // 设置防抖
            isProcessingClick = true;
            setTimeout(() => { isProcessingClick = false; }, 300);
            
            e.stopPropagation();
            
            // 如果是父节点，处理展开/收起
            if (nodeItem.classList.contains('parent-node')) {
                const treeNode = nodeItem.closest('.tree-node');
                const wasExpanded = treeNode.classList.contains('expanded');
                treeNode.classList.toggle('expanded');
                
                // 如果展开，同时切换到该页面
                if (treeNode.classList.contains('expanded') && !wasExpanded) {
                    const pageName = nodeItem.getAttribute('data-page');
                    if (pageName) {
                        switchSubPage(pageName);
                        // 默认显示第一个子页面（直接调用函数，不用click）
                        const firstSubPage = treeNode.querySelector('.sub-node');
                        if (firstSubPage) {
                            const subPageName = firstSubPage.getAttribute('data-sub-page');
                            if (subPageName) {
                                switchStatsSubPage(subPageName);
                                // 更新选中状态
                                document.querySelectorAll('.sub-node').forEach(node => {
                                    node.classList.remove('selected');
                                });
                                firstSubPage.classList.add('selected');
                            }
                        }
                    }
                }
            } 
            // 如果是子节点，切换子页面
            else if (nodeItem.classList.contains('sub-node')) {
                const subPageName = nodeItem.getAttribute('data-sub-page');
                if (subPageName) {
                    switchStatsSubPage(subPageName);
                    
                    // 更新子节点选中状态
                    document.querySelectorAll('.sub-node').forEach(node => {
                        node.classList.remove('selected');
                    });
                    nodeItem.classList.add('selected');
                }
            }
            // 普通节点
            else {
                const pageName = nodeItem.getAttribute('data-page');
                if (pageName) {
                    switchSubPage(pageName);
                }
            }
        });

        // 智能统计子页面切换
        function switchStatsSubPage(subPageName) {
            // 隐藏所有智能统计子页面
            document.querySelectorAll('.stats-sub-page').forEach(page => {
                page.classList.remove('active');
            });
            
            // 显示目标子页面
            const targetPage = document.getElementById('page-' + subPageName);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // 更新面包屑
            const subPageNames = {
                'stats-overview': '智能统计 / 概览',
                'stats-report': '智能统计 / 预测报告',
                'stats-risk': '智能统计 / 预测风险'
            };
            document.getElementById('currentSubPage').textContent = subPageNames[subPageName] || '智能统计';
            
            // 初始化对应的页面
            if (subPageName === 'stats-report' && typeof window.initPredictionReportPage === 'function') {
                console.log('🔄 Switching to Prediction Report page, initializing...');
                window.initPredictionReportPage();
            } else if (subPageName === 'stats-risk' && typeof window.initPredictionRiskPage === 'function') {
                console.log('🔄 Switching to Prediction Risk page, initializing...');
                window.initPredictionRiskPage();
            }
        }

        // 页面加载时，默认展开智能统计（如果需要）
        // document.querySelector('.parent-node[data-page="stats"]')?.closest('.tree-node').classList.add('expanded');

        // 表格行hover效果
        document.querySelectorAll('.data-table tbody tr').forEach(row => {
            row.addEventListener('mouseenter', function() {
                this.style.boxShadow = '0 4px 12px rgba(0,0,0,0.08)';
            });
            row.addEventListener('mouseleave', function() {
                this.style.boxShadow = 'none';
            });
        });

        // 按钮点击效果
        document.querySelectorAll('.btn-action, .btn-new').forEach(btn => {
            btn.addEventListener('click', function() {
                console.log('Button clicked:', this.textContent);
            });
        });

        // ==================== 算法模型服务管理功能 ====================

        // 监控类型与具体指标的映射关系
        const metricMapping = {
            'cpu': [
                { value: 'cpu_usage', text: 'CPU使用率' },
                { value: 'cpu_load', text: 'CPU负载' },
                { value: 'cpu_idle', text: 'CPU空闲率' },
                { value: 'cpu_iowait', text: 'CPU等待IO时间' }
            ],
            'memory': [
                { value: 'memory_usage', text: '内存使用率' },
                { value: 'memory_available', text: '可用内存' },
                { value: 'memory_swap', text: '交换内存使用率' },
                { value: 'memory_buffer', text: '缓冲区内存' }
            ],
            'disk': [
                { value: 'disk_usage', text: '磁盘使用率' },
                { value: 'disk_io', text: '磁盘IO' },
                { value: 'disk_read', text: '磁盘读取速度' },
                { value: 'disk_write', text: '磁盘写入速度' }
            ],
            'network': [
                { value: 'network_in', text: '网络入流量' },
                { value: 'network_out', text: '网络出流量' },
                { value: 'network_packets', text: '网络包数' },
                { value: 'network_errors', text: '网络错误数' }
            ],
            'temperature': [
                { value: 'cpu_temp', text: 'CPU温度' },
                { value: 'gpu_temp', text: 'GPU温度' },
                { value: 'motherboard_temp', text: '主板温度' },
                { value: 'hard_disk_temp', text: '硬盘温度' }
            ]
        };

        // 更新具体指标下拉框
        function updateSpecificMetrics() {
            const categorySelect = document.getElementById('metricCategory');
            const specificSelect = document.getElementById('specificMetric');
            
            if (!categorySelect || !specificSelect) return;
            
            const selectedCategory = categorySelect.value;
            
            // 清空具体指标选项
            specificSelect.innerHTML = '<option value="">选择具体指标</option>';
            
            // 如果选择了监控类型，添加对应的具体指标
            if (selectedCategory && metricMapping[selectedCategory]) {
                metricMapping[selectedCategory].forEach(metric => {
                    const option = document.createElement('option');
                    option.value = metric.value;
                    option.textContent = metric.text;
                    specificSelect.appendChild(option);
                });
            }
        }

        // 从检测模板加载具体指标（用于关联检测模板）
        function loadDetectionTemplates() {
            // 从后端API获取检测模板数据
            return fetch('/api/detection-templates')
                .then(response => response.json())
                .then(result => {
                    if (result.code === 200) {
                        return result.data.map(template => ({
                            id: template.id,
                            templateName: template.templateName || template.template_name,
                            detectionType: template.detectionType || template.detection_type
                        }));
                    } else {
                        throw new Error(result.message || 'API调用失败');
                    }
                })
                .catch(error => {
                    console.error('加载检测模板失败:', error);
                    // 如果API调用失败，返回模拟数据作为后备
                    return [
                        { id: 1, templateName: 'CPU高使用率检测', detectionType: 'cpu' },
                        { id: 2, templateName: '内存泄漏检测', detectionType: 'memory' },
                        { id: 3, templateName: '磁盘空间不足检测', detectionType: 'disk' },
                        { id: 4, templateName: '网络异常流量检测', detectionType: 'network' },
                        { id: 5, templateName: '设备过热检测', detectionType: 'temperature' }
                    ];
                });
        }

        // 根据监控类型获取对应的检测模板
        function getTemplatesByMonitoringType(monitoringType) {
            return loadDetectionTemplates().then(templates => {
                return templates.filter(template => template.detectionType === monitoringType);
            });
        }

        // 新建算法模型服务按钮点击事件
        document.addEventListener('DOMContentLoaded', function() {
            const newModelBtn = document.querySelector('.btn-new-model');
            if (newModelBtn) {
                newModelBtn.addEventListener('click', function() {
                    showModelServiceModal();
                });
            }
        });

        // 显示新建算法模型服务弹窗
        function showModelServiceModal() {
            const modal = document.getElementById('modelServiceModal');
            const title = document.getElementById('modelServiceModalTitle');
            const form = document.getElementById('modelServiceForm');
            
            if (title) title.textContent = '新建算法模型服务';
            if (form) form.reset();
            
            // 清空隐藏的ID字段
            const serviceId = document.getElementById('modelServiceId');
            if (serviceId) serviceId.value = '';
            
            // 设置默认值
            const autoPrediction = document.getElementById('autoPrediction');
            if (autoPrediction) autoPrediction.checked = true;
            
            const updateCycle = document.getElementById('updateCycle');
            if (updateCycle) updateCycle.value = '7';
            
            const predictionCycle = document.getElementById('predictionCycle');
            if (predictionCycle) predictionCycle.value = '1';
            
            const predictionDuration = document.getElementById('predictionDuration');
            if (predictionDuration) predictionDuration.value = '1';
            
            if (modal) {
                modal.style.display = 'flex';
                
                // 聚焦到服务名称输入框
                const serviceNameInput = document.getElementById('serviceName');
                if (serviceNameInput) {
                    setTimeout(() => serviceNameInput.focus(), 100);
                }
            }
        }

        // 关闭算法模型服务弹窗
        function closeModelServiceModal() {
            const modal = document.getElementById('modelServiceModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        // 保存算法模型服务
        function saveModelService() {
            const form = document.getElementById('modelServiceForm');
            const formData = new FormData(form);
            
            // 验证表单
            if (!validateModelServiceForm()) {
                return;
            }
            
            const serviceData = {
                id: formData.get('id') || null,
                // 步骤1: 计算方式
                algorithmType: 'KNN',
                
                // 步骤2: 数据源
                deviceSelection: formData.get('deviceSelection'),
                metricCategory: formData.get('metricCategory'),
                specificMetric: formData.get('specificMetric'),
                
                // 步骤3: 模型参数
                updateCycle: parseInt(formData.get('updateCycle')) || 7,
                
                // 步骤4: 预测策略
                autoPrediction: formData.get('autoPrediction') === 'on',
                predictionCycle: parseInt(formData.get('predictionCycle')) || 1,
                predictionDuration: parseInt(formData.get('predictionDuration')) || 1,
                
                // 步骤5: 基本信息
                serviceName: formData.get('serviceName'),
                serviceNotes: formData.get('serviceNotes')
            };
            
            console.log('保存算法模型服务:', serviceData);
            
            // 这里应该调用后端API保存数据
            // 模拟保存成功
            alert('算法模型服务创建成功！');
            
            // 关闭弹窗
            closeModelServiceModal();
            
            // 刷新表格数据（这里可以调用刷新函数）
            // refreshModelServiceTable();
        }

        // 验证算法模型服务表单
        function validateModelServiceForm() {
            const serviceName = document.getElementById('serviceName').value.trim();
            
            if (!serviceName) {
                alert('请输入算法模型服务名称');
                document.getElementById('serviceName').focus();
                return false;
            }
            
            // 验证数值字段
            const updateCycle = document.getElementById('updateCycle').value;
            if (updateCycle && (isNaN(updateCycle) || parseInt(updateCycle) < 1)) {
                alert('模型更新周期必须是大于0的数字');
                document.getElementById('updateCycle').focus();
                return false;
            }
            
            const predictionCycle = document.getElementById('predictionCycle').value;
            if (predictionCycle && (isNaN(predictionCycle) || parseInt(predictionCycle) < 1)) {
                alert('预测周期时间必须是大于0的数字');
                document.getElementById('predictionCycle').focus();
                return false;
            }
            
            const predictionDuration = document.getElementById('predictionDuration').value;
            if (predictionDuration && (isNaN(predictionDuration) || parseInt(predictionDuration) < 1)) {
                alert('预测时长必须是大于0的数字');
                document.getElementById('predictionDuration').focus();
                return false;
            }
            
            return true;
        }

        // ESC键关闭弹窗
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const modal = document.getElementById('modelServiceModal');
                if (modal && modal.style.display === 'flex') {
                    closeModelServiceModal();
                }
            }
        });
    </script>
    
    <!-- ECharts图表库 -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    
    <!-- 智能预测管理API模块 -->
    <script src="js/prediction-api.js"></script>
    
    <!-- 概览页面逻辑 -->
    <script src="js/prediction-overview.js"></script>
    
    <!-- 预测报告页面逻辑 -->
    <script src="js/prediction-report.js"></script>
    
    <!-- 预测风险页面逻辑 -->
    <script src="js/prediction-risk.js"></script>
</body>
</html>
